<nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
  <div class="position-sticky pt-3 sidebar-sticky">
    <ul class="nav flex-column">
      <% if (navigationMenu) { %>
        <%# Main navigation (routes without section) %>
        <% if (navigationMenu.main && navigationMenu.main.length > 0) { %>
          <% navigationMenu.main.forEach(route => { %>
            <li class="nav-item">
              <a class="nav-link <%= currentPath === route.path || currentPath.startsWith(route.path + '/') ? 'active' : '' %>" href="<%= route.path %>">
                <i class="bi <%= route.icon %>"></i> <%= route.label %>
              </a>
            </li>
          <% }); %>
        <% } %>

        <%# Security section %>
        <% if (navigationMenu.Security && navigationMenu.Security.length > 0) { %>
          <li class="nav-item">
            <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted text-uppercase">
              <span>Security</span>
            </h6>
          </li>
          <% navigationMenu.Security.forEach(route => { %>
            <li class="nav-item">
              <a class="nav-link <%= currentPath === route.path || currentPath.startsWith(route.path + '/') ? 'active' : '' %>" href="<%= route.path %>">
                <i class="bi <%= route.icon %>"></i> <%= route.label %>
              </a>
            </li>
          <% }); %>
        <% } %>

        <%# Administration section %>
        <% if (navigationMenu.Administration && navigationMenu.Administration.length > 0) { %>
          <li class="nav-item">
            <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted text-uppercase">
              <span>Administration</span>
            </h6>
          </li>
          <% navigationMenu.Administration.forEach(route => { %>
            <li class="nav-item">
              <a class="nav-link <%= currentPath === route.path || currentPath.startsWith(route.path + '/') ? 'active' : '' %>" href="<%= route.path %>">
                <i class="bi <%= route.icon %>"></i> <%= route.label %>
              </a>
            </li>
          <% }); %>
        <% } %>
      <% } %>
    </ul>
  </div>
</nav>

        <li class="nav-item">
          <a class="nav-link <%= currentPath === '/audit' ? 'active' : '' %>" href="/audit">
            <i class="bi bi-clock-history"></i> Audit Log
          </a>
        </li>
        <% } %>
        <% if (hasCapability('settings:read')) { %>
        <li class="nav-item">
          <a class="nav-link <%= currentPath === '/settings' ? 'active' : '' %>" href="/settings">
            <i class="bi bi-gear"></i> Settings
          </a>
        </li>
        <% } %>
        <% } %>
      <% } %>
    </ul>
  </div>
</nav>
